# Semantic RAG Pipeline Configuration
# =================================

# Experiment Configuration
experiment:
  name: "semantic_rag_pipeline"
  description: "Semantic graph traversal RAG system"
  version: "1.0.0"
  tags: ["semantic_chunking", "graph_traversal", "rag"]

# System Configuration
system:
  device: "auto"  # auto, cpu, cuda, mps
  max_memory_gb: 8  # Maximum memory usage warning threshold
  min_disk_space_gb: 5  # Minimum disk space required
  num_workers: 4  # For parallel processing

# Directory Structure
directories:
  data: "data"
  embeddings: "embeddings"
  visualizations: "visualizations"
  logs: "logs"
  configs: "configs"

# Logging Configuration
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  log_to_file: true
  log_to_console: true
  max_log_file_mb: 100
  backup_count: 5

# Pipeline Execution
execution:
  mode: "full_pipeline"  # full_pipeline, data_only, embedding_only, evaluation_only, visualization_only
  skip_phases: []  # List of phases to skip
  force_recompute: []  # List of components to force recomputation

# Models Configuration (basic for Phase 1)
models:
  embedding_models:
    - "sentence-transformers/all-mpnet-base-v2"
    - "sentence-transformers/all-MiniLM-L6-v2"
  embedding_batch_size: 32
  embedding_cache: true

# Wikipedia Configuration
wikipedia:
  use_cached_articles: true
  topics:
    - "Machine learning"
    - "Artificial intelligence"
    - "Natural language processing"
    - "Computer vision"
    - "Deep learning"
    - "Neural networks"
    - "Data science"
    - "Statistics"
  articles_per_topic: 5  # Max articles to fetch per topic
  max_article_length: 5000000  # Skip articles longer than this (chars)
  min_article_length: 1000   # Skip articles shorter than this (chars)
  language: "en"
  rate_limit_delay: 1.0  # Seconds between API calls
  retry_attempts: 3
  timeout_seconds: 30

# Text Processing
text_processing:
  clean_html: true
  remove_references: true
  remove_navigation: true
  remove_tables: true
  fix_encoding: true
  normalize_whitespace: true
  min_sentence_length: 10
  max_sentence_length: 500

# Basic chunking configuration (will expand later)
chunking:
  strategy: "sliding_window"  # sliding_window, sentence_based, similarity_matrix
  window_size: 3
  overlap: 1

# Enhanced retrieval configuration with knowledge graph support
retrieval:
  algorithm: "semantic_traversal"  # semantic_traversal, baseline_vector, hybrid
  cache_graphs: true
  use_knowledge_graph: true         # Enable knowledge graph enhanced retrieval
  
  # Semantic Traversal Parameters
  semantic_traversal:
    num_anchors: 3                    # Number of anchor points from baseline
    max_hops: 3                      # Maximum traversal hops from each anchor
    similarity_threshold: 0.3        # Minimum similarity to continue traversal
    max_results: 10                  # Maximum chunks to return after reranking
    relationship_types: ["entity_similarity", "thematic_similarity", "embedding_similarity"]  # KG relationships to use
    
  # Baseline Vector Parameters (for anchor finding)
  baseline_vector:
    top_k: 10                        # Top-k for anchor finding
    similarity_threshold: 0.5        # Minimum similarity for anchors

# Similarity Matrix Configuration
similarities:
  use_cached: true
  similarity_metric: "cosine"  # cosine, dot_product, euclidean
  intra_document:
    enabled: true
    top_k: 10  # Top K most similar chunks within same document
  inter_document:
    enabled: true
    top_x: 5   # Top X most similar chunks from other documents
  batch_size: 1000  # Batch size for similarity computation
  max_memory_gb: 4  # Memory limit for matrix computation

# Knowledge Graph Configuration
knowledge_graph:
  use_cached: true
  
  # Sparsity Configuration - Crucial for scalability
  sparsity:
    max_relationships_per_node: 25        # Hard limit per node
    relationship_limits:
      entity_similarity: 10               # Top 10 per node
      thematic_similarity: 5              # Top 5 per node  
      embedding_similarity: 10            # Top 10 per node
      hierarchical: 1000                  # Unlimited for doc->chunk
    min_thresholds:
      entity_similarity: 0.3              # Much higher threshold
      thematic_similarity: 0.6            # Much higher threshold
      embedding_similarity: 0.5           # Higher threshold
  
  extractors:
    ner:
      enabled: true
      entity_types: ["PERSON", "ORG", "GPE", "MISC"]
    keyphrases:
      enabled: true
      max_features: 20
    themes:
      enabled: true
      max_themes: 5
    summary:
      enabled: true
      max_sentences: 2
  relationships:
    entity_similarity:
      enabled: true
      min_similarity: 0.3
      entity_types: ["PERSON", "ORG", "GPE", "MISC"]
    thematic_similarity:
      enabled: true
      min_similarity: 0.6
    embedding_similarity:
      enabled: true
      min_similarity: 0.5
    hierarchical:
      enabled: true
  export_format: "json"
  save_path: "data/knowledge_graph.json"

# Dataset configuration (will expand later)
datasets:
  use_cached: true
  generation_method: "mixed"  # ragas, custom, mixed
  
  # RAGAS Configuration
  ragas:
    num_questions: 50
    question_types: ["factual", "reasoning", "multi_context"]
    difficulty_levels: ["easy", "medium", "hard"]
    
  # Custom Question Generation
  custom:
    num_questions: 100
    focus_areas:
      - "conceptual_relationships" 
      - "multi_hop_reasoning"
      - "contextual_understanding" 
      - "reading_flow"
    semantic_bias: 0.7  # Favor semantic traversal advantages
    
  # Quality Control
  validation:
    min_answer_length: 50
    max_answer_length: 500
    require_multiple_chunks: true
    manual_validation_sample: 0.1

# Evaluation configuration (will expand later)
evaluation:
  include_ragas_metrics: true
  include_custom_metrics: true
  include_baseline_comparison: true

# Visualization configuration (will expand later)
visualization:
  enabled: true
  similarity_matrices: true
  traversal_paths: true
  chunk_boundaries: true

# Output configuration
output:
  create_report: true
  export_data: true
  save_models: false

# Cleanup configuration
cleanup:
  remove_temp_files: false
  compress_large_files: true

# Notifications (for later)
notifications:
  enabled: false